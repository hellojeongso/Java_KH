DROP TABLE X,S,M;

CREATE TABLE M
(M1 CHAR(6), M2 VARCHAR(10));
CREATE TABLE S
(S1 CHAR(6), S2 VARCHAR(10));
CREATE TABLE X
(X1 CHAR(6), X2 VARCHAR(10));

INSERT INTO M VALUES('A','1');
INSERT INTO M VALUES('B','1');
INSERT INTO M VALUES('C','3');
INSERT INTO M VALUES(NULL, '3');

INSERT INTO S VALUES('A','X');
INSERT INTO S VALUES('B','Y');
INSERT INTO S VALUES(NULL, 'Z');

INSERT INTO X VALUES('A','DATA');
COMMIT;




SELECT * FROM S;
SELECT * FROM X;
SELECT * FROM M;

-- INNER JOIN
SELECT * FROM M JOIN S ON M1 = S1;
SELECT * FROM M,S WHERE M1 = S1;


-- CROSS JOIN
--ANSI "표준" SQL
SELECT * FROM M CROSS JOIN S;
--ORACLE SQL 
SELECT * FROM M,S;

--LEFT OUTER JOIN
SELECT * FROM M LEFT OUTER JOIN S ON M1 = S1;
SELECT * FROM M,S WHERE M1 = S1(+);

--RIGHT OUTER JOIN
SELECT * FROM M RIGHT OUTER JOIN S ON M1 = S1;
SELECT * FROM M,S WHERE M1(+) = S1;

-- NON EQUI JOIN
SELECT ENAME, SAL,GRADE
FROM EMP JOIN SALGRADE ON (SAL BETWEEN LOSAL AND HISAL);

SELECT E.ENAME, E.SAL, S.GRADE
FROM EMP E, SALGRADE S
WHERE E.SAL BETWEEN S.LOSAL AND S.HISAL;


--SELECT * FROM SALGRADE;
--SELECT * FROM EMP;
-- 오류 SELECT 사원.EMPNO, 사원.ENAME, 관리자.EMPNO, 관리자.ENAME
--FROM EMP 사원 LEFT OUTER JOIN EMP 괸리자 ON 사원.MGR = 관리자.EMPNO;


SELECT 사원.EMPNO, 사원.ENAME, 관리자.EMPNO, 관리자.ENAME
FROM EMP 사원, EMP 관리자
WHERE 사원.MGR = 관리자.EMPNO

SELECT * FROM EMP;

-- KING은 관리자가 없어서 출력이 안됐음. 킹을 나오게 하려면? 
-- LEFT OUTER JOIN 





